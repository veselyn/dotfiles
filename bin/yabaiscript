#!/usr/bin/env sh

start() {
  brew services start "$1"
}

stop() {
  brew services stop "$1"
}

restart() {
  brew services restart "$1"
}

is_floating() {
  is_floating=$(yabai -m query --windows --window | jq '."is-floating"')

  if [ "$is_floating" = false ]; then
    return 1
  fi

  if [ "$is_floating" = true ]; then
    return 0
  fi
}

resize_left() {
  if is_floating; then
    yabai -m window --move rel:-10:0
    return
  fi

  yabai -m window --resize left:-10:0
  yabai -m window --resize right:-10:0
}

resize_bottom() {
  if is_floating; then
    yabai -m window --move rel:0:10
    return
  fi

  yabai -m window --resize bottom:0:10
  yabai -m window --resize top:0:10
}

resize_top() {
  if is_floating; then
    yabai -m window --move rel:0:-10
    return
  fi

  yabai -m window --resize top:0:-10
  yabai -m window --resize bottom:0:-10
}

resize_right() {
  if is_floating; then
    yabai -m window --move rel:10:0
    return
  fi

  yabai -m window --resize right:10:0
  yabai -m window --resize left:10:0
}

case $1 in
start)
  case $2 in
  yabai)
    start yabai
    ;;
  skhd)
    start skhd
    ;;
  *)
    start yabai
    start skhd
    ;;
  esac
  ;;
stop)
  case $2 in
  yabai)
    stop yabai
    ;;
  skhd)
    stop skhd
    ;;
  *)
    stop yabai
    stop skhd
    ;;
  esac
  ;;
restart)
  case $2 in
  yabai)
    restart yabai
    ;;
  skhd)
    restart skhd
    ;;
  *)
    restart yabai
    restart skhd
    ;;
  esac
  ;;
resize)
  case $2 in
  left)
    resize_left
    ;;
  bottom)
    resize_bottom
    ;;
  top)
    resize_top
    ;;
  right)
    resize_right
    ;;
  esac
  ;;
esac
